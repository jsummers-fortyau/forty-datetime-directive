(function(){angular.module("fortyDate",[]).directive("fortyDatePicker",['$filter','$window',function(a,b){return{require:"ngModel",restrict:"E",replace:!0,scope:{date:"=ngModel",disabled:"=",name:"=?",placeholder:"=?",options: '=?'},template:'<div class="input-group"><input type="text" class="form-control" uib-datepicker-popup="{{format}}" datepicker-options="options" ng-model="date" name="{{name}}" is-open="opened" placeholder="{{placeholder}}" ng-disabled="disabled" /><span class="input-group-btn"><button type="button" ng-disabled="disabled" class="btn btn-default" ng-click="open($event)"><i class="fa fa-calendar"></i></button></span></div>',link:function(b,c,d,e){var f,g,h,i,j,k,l,m,n,o;return f=void 0,i=void 0,l=void 0,m=void 0,k=function(){return f=[96,97,98,99,100,101,102,103,104,105],i="/",l=b.format.toLowerCase().replace(/\w/g,"_"),m=angular.element(c.find("input")).data("$ngModelController"),_.isDate(b.date)||m.$setViewValue(l),!0},n=function(a,b){var c;if(a)return a.value=a.value,a.createTextRange?(c=a.createTextRange(),c.move("character",b),c.select(),!0):a.selectionStart||0===a.selectionStart?(a.focus(),a.setSelectionRange(b,b),!0):(a.focus(),!1)},g=function(a){var c,d;return c=0,d=_.map(b.format.split(""),function(b){var d;return b===i?i:(d=a[c],void 0===a[c]&&(d="_"),c++,d)})},j=function(a){return null==a&&(a=void 0),a?c.find("input")[0].value.substr(0,a).replace(/\w/g,"").length:0},h=function(a,d){var e,f,h,i,k,l,o;null==d&&(d=0),(0!==a.selectionStart||0!==d||a.selectionStart!==a.selectionEnd)&&(a.selectionStart!==b.format.length||1!==d)&&(h=a.value.replace(/\W/g,"").split(""),o=a.selectionStart,a.selectionEnd===a.selectionStart&&(o-=1),i=j(o+d),l=j(a.selectionStart),k=j(a.selectionEnd),f=a.selectionEnd-k-(a.selectionStart-l),f=0===f?1:f,h.splice(o-i+d,f),m.$setViewValue(g(h).join("")),m.$render(),e=o+d,n(c.find("input")[0],e))},o=function(a,b){var d,e,f,h,j,k,l;return e=a.value.split(""),l=a.selectionStart,h=a.value.substr(0,l).replace(/\w/g,"").length,f=a.value.replace(/\W/g,"").split(""),j=l-h,f.indexOf("_")>-1&&f.indexOf("_")<j&&(j=f.indexOf("_")),null!==b&&f.splice(j,0,b),k=g(f).join(""),m.$setViewValue(k),m.$render(),d=e[j+1]===i?2:1,d+=h,n(c.find("input")[0],j+d),k},c.find("input").on("paste",function(a){return a.preventDefault(),this.value=a.clipboardData.getData("text/plain"),o(this,null)}),c.find("input").on("keydown",function(a){var b;return b=a.keyCode||a.which,8===b||46===b?(h(this,8===b?0:1),a.preventDefault(),!1):void 0}),c.find("input").on("keypress",function(a){var d,e;if(e=a.keyCode||a.which,9!==e){if(a.preventDefault(),this.value.replace(/\_/g,"").length===b.format.length)return!1;if(isNaN(parseInt(String.fromCharCode(e))))return!1;d=c.find("input")[0],d.value===l&&n(d,0),o(d,String.fromCharCode(a.keyCode))}}),c.find("input").on("blur",function(){return m.$viewValue!==l?void 0===a("date")(b.date,b.format)?c.addClass("has-error"):c.removeClass("has-error"):void 0}),b.opened=!1,b.format="MM/dd/yyyy",b.placeholder=b.placeholder||"__/__/____",b.open=function(a){a.preventDefault(),a.stopPropagation(),b.opened=!b.opened},k(),m.$parsers.unshift(function(a){return a}),m.$formatters.unshift(function(a){return a})}}}])}).call(this);